<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gráfica de Visitas</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      background-color: #222;
      color: #fff; 
      font-family: Arial, sans-serif; 
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }
    #myChart {
      max-width: 800px;
      width: 100%; 
      margin-bottom: 20px;
    }
    .info {
      text-align: center; 
      margin-bottom: 20px; 
    }
    .info h1 {
      font-size: 20px; 
      margin-bottom: 10px;
    }
    .info p {
      font-size: 16px; 
      line-height: 1.5;
    }
  </style>
</head>
<body>
  <div class="info">
    <h1>Gráfica de Visitas</h1>
    <p>Bienvenido a nuestra herramienta en línea para visualizar la cantidad de visitantes que ha recibido nuestra página webcodem.</p>
    <p>Esta gráfica muestra el número de visitas a lo largo del tiempo y se actualiza automáticamente cada vez que alcanza las 10000 visitas. También se actualiza cada minuto para mostrar los datos más recientes. Es una herramienta útil para entender la popularidad de nuestra página web y cómo fluctúa el tráfico a lo largo del tiempo.</p>
    <p>¡Explora y descubre cuántas personas están visitando nuestra página!</p>
  </div>
  <canvas id="myChart"></canvas> 
  <script>
    var myChart; 
    var maxVisitas = 10000; 
    var intervaloActualizacion = 60 * 1000; 

    function getTotalVisitas() {
      return parseInt(localStorage.getItem('totalVisitas')) || 0;
    }

    function reiniciarGrafica() {
      localStorage.setItem('totalVisitas', 0);
      actualizarGrafico();
    }

    function simularFluctuacion(visitas) {
      
      return visitas + Math.floor(Math.random() * 11) - 5;
    }

    function actualizarGrafico() {
      var totalVisitas = getTotalVisitas();
      var visitasAnteriores = [];

      for (var i = 0; i < totalVisitas; i++) {
        if (i === 0) {
          visitasAnteriores.push(20); 
        } else {
          var visitasAnterioresDiaAnterior = visitasAnteriores[i - 1];
          visitasAnteriores.push(simularFluctuacion(visitasAnterioresDiaAnterior));
        }
      }

      var data = {
        labels: Array.from({ length: totalVisitas }, (_, index) => 'Visita ' + (index + 1)),
        datasets: [{
          label: 'Visitas',
          data: visitasAnteriores,
          backgroundColor: 'rgba(54, 162, 235, 0.2)',
          borderColor: 'rgba(54, 162, 235, 1)',
          borderWidth: 1,
          pointRadius: 0 
        }]
      };

      var options = {
        scales: {
          y: {
            beginAtZero: true,
            ticks: {
              stepSize: 10 
            }
          }
        }
      };

      var ctx = document.getElementById('myChart').getContext('2d');

      if (myChart) {
        myChart.destroy();
      }

      myChart = new Chart(ctx, {
        type: 'line', 
        data: data,
        options: options
      });
    }

    function avanzarVisita() {
      var totalVisitas = getTotalVisitas();
      if (totalVisitas >= maxVisitas) {
        reiniciarGrafica();
      } else {
        localStorage.setItem('totalVisitas', totalVisitas + 1);
        actualizarGrafico();
      }
    }

    actualizarGrafico();
    setInterval(avanzarVisita, intervaloActualizacion); 
  </script>
</body>
</html>
